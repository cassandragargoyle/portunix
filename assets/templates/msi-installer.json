{
  "apiVersion": "v1",
  "kind": "PackageTemplate",
  "metadata": {
    "name": "msi-installer",
    "displayName": "MSI Installer Template",
    "description": "Template for Windows MSI installer packages",
    "category": "installer-templates",
    "version": "1.0.0"
  },
  "spec": {
    "targetPlatform": "windows",
    "installerType": "msi",
    "defaultStructure": {
      "platforms": {
        "windows": {
          "type": "msi",
          "variants": {
            "latest": {
              "version": "{{VERSION}}",
              "urls": {
                "x64": "{{DOWNLOAD_URL_X64}}",
                "x86": "{{DOWNLOAD_URL_X86}}"
              },
              "installPath": "${ProgramFiles}/{{VENDOR}}/{{PRODUCT_NAME}}"
            }
          },
          "installArgs": ["{{INSTALL_ARGS}}"],
          "verification": {
            "command": "{{VERIFICATION_COMMAND}}",
            "expectedExitCode": 0
          },
          "environment": {
            "{{ENV_VAR_NAME}}": "${install_path}",
            "PATH_APPEND": "${install_path}/bin"
          }
        }
      }
    },
    "requiredVariables": [
      {
        "name": "VERSION",
        "description": "Version number of the software",
        "example": "1.2.3"
      },
      {
        "name": "DOWNLOAD_URL_X64",
        "description": "Download URL for 64-bit installer",
        "example": "https://example.com/software-x64.msi"
      },
      {
        "name": "DOWNLOAD_URL_X86",
        "description": "Download URL for 32-bit installer",
        "example": "https://example.com/software-x86.msi"
      },
      {
        "name": "VENDOR",
        "description": "Software vendor name",
        "example": "Microsoft"
      },
      {
        "name": "PRODUCT_NAME",
        "description": "Product name for installation path",
        "example": "Visual Studio Code"
      },
      {
        "name": "INSTALL_ARGS",
        "description": "MSI installation arguments",
        "example": "/quiet /norestart"
      },
      {
        "name": "VERIFICATION_COMMAND",
        "description": "Command to verify installation",
        "example": "code --version"
      },
      {
        "name": "ENV_VAR_NAME",
        "description": "Environment variable name to set",
        "example": "JAVA_HOME"
      }
    ],
    "commonPatterns": {
      "silentInstall": ["/quiet", "/norestart"],
      "verboseInstall": ["/quiet", "/l*v", "install.log"],
      "javaLikeInstall": ["ADDLOCAL=ALL", "/quiet"],
      "userInstall": ["/S", "/currentuser"],
      "systemInstall": ["/S", "/allusers"]
    },
    "examples": [
      {
        "name": "Basic MSI Package",
        "description": "Simple MSI installer with silent installation",
        "variables": {
          "VERSION": "1.0.0",
          "DOWNLOAD_URL_X64": "https://example.com/app-x64.msi",
          "DOWNLOAD_URL_X86": "https://example.com/app-x86.msi",
          "VENDOR": "ExampleCorp",
          "PRODUCT_NAME": "ExampleApp",
          "INSTALL_ARGS": "/quiet /norestart",
          "VERIFICATION_COMMAND": "exampleapp --version",
          "ENV_VAR_NAME": "EXAMPLE_HOME"
        }
      }
    ]
  }
}